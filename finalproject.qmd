---
title: "Final Project"
author: "Majorz"
format: pdf
---

```{r read-data, message = F, warning = F}
library(tidyverse)
library(tidymodels)
library(glmnet)
spotify <- read_csv("data/tf_mini.csv")
```

```{r logistic-model, message = F, warning = F}
spotify_mode <- spotify |>
  mutate(new_mode = if_else(mode == "major", 1, 0), 
         new_mode = as.numeric(new_mode))

spotify_mode |> drop_na(new_mode)

glm_all_mode <- glm(new_mode ~ us_popularity_estimate + duration + release_year + acousticness + 
     beat_strength + bounciness + danceability + dyn_range_mean + energy + 
     flatness + instrumentalness + key + liveness + loudness + mechanism + 
       organism + speechiness + tempo + time_signature + valence,
     data = spotify_mode,
     family = "binomial")
summary(glm_all_mode)
```

```{r lasso, message = F, warning = F, include = FALSE}
y <- spotify_mode$new_mode
x <- model.matrix(new_mode ~ us_popularity_estimate + duration + release_year + 
                acousticness + beat_strength + bounciness + danceability + 
                  dyn_range_mean + energy + flatness + instrumentalness + key + 
                  liveness + loudness + mechanism + organism + speechiness + 
                  tempo + time_signature + valence,
                  data = spotify_mode, family = "binomial")
lasso_sc <- cv.glmnet(x, y, alpha = 1)
best_lambda <- lasso_sc$lambda.min
lasso_final <- glmnet(x, y, alpha = 1, lambda = best_lambda)
lasso_final$beta
```

```{r lasso-plot, message = F, warning = F}
plot(lasso_sc)
```

## Introduction and Data

## Methodology

## Results

## Discussion

